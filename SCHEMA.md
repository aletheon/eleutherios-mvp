# Eleutherios Schema v2

## Overview
This schema defines the core data models of the **Policy–Forum–Service–Data (PFSD)** protocol as implemented in Eleutherios. It integrates governance concepts with technical system requirements and supports both analogue and digital stakeholders.

---

## 1. Policy

**Description:**  
Policies are the root governance objects. They contain rules that define how services, forums, or other policies are instantiated and interact.

**Fields:**
- `id` (string, UUID)  
- `title` (string)  
- `description` (string, markdown supported)  
- `visibility`: `public | private`  
- `ownerId` (ref → User)  
- `rules[]` (array of Rule objects)  
- `createdAt` (timestamp)  
- `updatedAt` (timestamp)  

---

## 2. Rule

**Description:**  
Rules define the active behaviors inside a policy. They are **pointers** to other entities and only instantiate at runtime when consumed by a Service.

**Fields:**
- `id` (string, UUID)  
- `name` (string)  
- `type`: `Forum | Service | PolicyRef`  
- `targetRef`: (ref → Forum, Service, Policy)  
- `defaultStakeholders[]` (array of User/Service IDs, only for Forum rules)  
- `parameters` (JSON, e.g., currency, size options, API endpoint)  

---

## 3. Forum

**Description:**  
Forums are instantiated expressions of rules for discussion, collaboration, and coordination.

**Fields:**
- `id` (string, UUID)  
- `policyId` (ref → Policy)  
- `title` (string)  
- `description` (string)  
- `stakeholders[]` (array of User/Service IDs)  
- `permissions[]` (Permission matrix for each stakeholder)  
- `messages[]` (array of Message objects)  
- `files[]` (array of FileRefs)  
- `createdAt` (timestamp)  

**Permissions (defaults per stakeholder):**
- Add stakeholder: Yes/No  
- Remove stakeholder: Yes/No  
- Create sub-forum: Yes/No  
- Post message: Yes/No  
- Remove own message: Yes/No  
- Remove others’ messages: Yes/No  
- Add file: Yes/No  
- Remove own file: Yes/No  
- Remove others’ files: Yes/No  

---

## 4. Service

**Description:**  
Services are analogue or digital entities that perform actions, consume policies, or provide outputs.

**Fields:**
- `id` (string, UUID)  
- `title` (string)  
- `description` (string)  
- `ownerId` (ref → User)  
- `policyRefs[]` (array of Policy IDs consumed)  
- `attributes` (ServiceAttributes object)  
- `status`: Active / Inactive  
- `createdAt` (timestamp)  

**ServiceAttributes:**  
- `price` (number, optional if paid)  
- `currency` (string, e.g., NZD, USD)  
- `size` (string or enum, optional)  
- `color` (string, optional)  
- `quantity` (integer, stock available)  
- `free` (boolean, true if service is free)  

---

## 5. Data

**Description:**  
Raw records generated by services, forums, or policies. Stored for analytics, governance, and auditing.

**Fields:**
- `id` (string, UUID)  
- `sourceId` (ref → Service/Forum/Policy)  
- `payload` (JSON blob)  
- `timestamp` (timestamp)  

---

## 6. User

**Description:**  
Users are stakeholders in the system, representing individuals or organisations.

**Fields:**
- `id` (string, UUID)  
- `name` (string)  
- `email` (string)  
- `certScore` (CERT aggregate)  
- `services[]` (array of Service IDs owned)  
- `activities[]` (array of Activity IDs)  
- `followers[]` (User IDs)  
- `following[]` (User IDs)  
- `favourites[]` (Service IDs)  
- `createdAt` (timestamp)  

**CERT Breakdown:**  
- Cooperation = services from others added to policies/forums.  
- Engagement = response speed + good ratings/reviews.  
- Retention:  
  - For-profit → follow-up sales.  
  - Non-profit/free → follow-up uses.  
- Trust = number of followers/subscribers.  

---

## 7. Activity

**Description:**  
Tracks what a user is actively engaged in.

**Fields:**
- `id` (string, UUID)  
- `userId` (ref → User)  
- `forumRefs[]` (array of Forum IDs)  
- `policyRefs[]` (array of Policy IDs)  
- `timestamp` (last accessed)  

---

## 8. Newsfeed

**Description:**  
Aggregates updates for a user based on their follows, favourites, and notifications.

**Fields:**
- `id` (string, UUID)  
- `userId` (ref → User)  
- `entries[]` (array of FeedEntry objects)  

**FeedEntry:**  
- `id` (string, UUID)  
- `sourceType`: Service | Policy | Forum | User  
- `sourceId` (ref)  
- `message` (string, e.g., “Doctor updated status to Away”)  
- `timestamp` (timestamp)  
