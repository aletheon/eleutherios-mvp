<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eleutherios - Governance through Love in Action</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        /* Main Navigation */
        .main-nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: #4c51bf;
            text-decoration: none;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #4c51bf, #667eea);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-link {
            color: #6b7280;
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-link:hover,
        .nav-link.active {
            background: #4c51bf;
            color: white;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
        }

        .cart-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(76, 81, 191, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4c51bf;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cart-icon:hover {
            background: #4c51bf;
            color: white;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4c51bf, #667eea);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        /* User Menu Flyout */
        .user-menu-flyout {
            position: absolute;
            top: 50px;
            right: 0;
            width: 280px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(0, 0, 0, 0.1);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
        }

        .user-menu-flyout.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .user-menu-header {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .user-menu-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4c51bf, #667eea);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .user-details {
            flex: 1;
        }

        .user-menu-name {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 2px;
        }

        .user-menu-email {
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .user-menu-email:hover {
            color: #4c51bf;
        }

        .user-menu-stats {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .menu-stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .menu-stat-item:hover {
            background: #f3f4f6;
        }

        .stat-label {
            font-size: 14px;
            color: #374151;
        }

        .stat-count {
            font-size: 14px;
            color: #6b7280;
        }

        .user-menu-actions {
            padding: 0.5rem 0;
        }

        .menu-action-item {
            padding: 0.5rem 1rem;
            font-size: 14px;
            color: #374151;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .menu-action-item:hover {
            background: #f3f4f6;
        }

        .menu-action-item.logout {
            color: #dc2626;
        }

        .menu-action-item.logout:hover {
            background: #fef2f2;
        }

        /* Dashboard Styles */
        .dashboard-header {
            margin-bottom: 2rem;
        }

        .dashboard-header h1 {
            color: #1f2937;
            font-size: 2rem;
            font-weight: 700;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .dashboard-card h3 {
            color: #6b7280;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .balance-amount {
            color: #10b981;
            font-size: 2rem;
            font-weight: 700;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
        }

        .stat-number.blue {
            color: #3b82f6;
        }

        .stat-number.purple {
            color: #8b5cf6;
        }

        .income-stats {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .income-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 14px;
        }

        .income-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .income-dot.green {
            background: #10b981;
        }

        .income-dot.red {
            background: #ef4444;
        }

        .my-content-section {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .content-header h2 {
            color: #1f2937;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .view-toggle {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .toggle-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-btn.active {
            background: #4c51bf;
            color: white;
            border-color: #4c51bf;
        }

        .add-btn {
            width: 32px;
            height: 32px;
            background: #4c51bf;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .policy-item, .service-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }

        .policy-content, .service-content {
            flex: 1;
        }

        .policy-title, .service-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .policy-name, .service-name {
            font-weight: 600;
            color: #1f2937;
        }

        .policy-tag, .service-tag {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .policy-tag.housing, .service-tag.personal {
            background: #dcfce7;
            color: #166534;
        }

        .policy-tag.draft {
            background: #fef3c7;
            color: #92400e;
        }

        .policy-description, .service-description {
            color: #6b7280;
            font-size: 14px;
            margin-bottom: 0.5rem;
        }

        .policy-date {
            color: #6b7280;
            font-size: 12px;
        }

        .service-avatar {
            width: 32px;
            height: 32px;
            background: #6b7280;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 1rem;
        }

        .edit-btn {
            padding: 0.5rem 1rem;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .edit-btn:hover {
            background: #e5e7eb;
        }

        /* Page Container */
        .page-container {
            max-width: 100%;
            margin: 0 auto;
            min-height: calc(100vh - 80px);
            display: flex;
            position: relative;
            top: 0;
        }

        .page-content {
            padding: 2rem;
            width: 100%;
            transition: width 0.3s ease;
        }

        .page-content.activities-open {
            width: 60%;
            margin-left: 40%;
        }

        /* Page sections */
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        /* Activities sliding panel */
        .activities-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 0;
            height: 100vh;
            background: white;
            border-right: 2px solid #e5e7eb;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            transition: width 0.3s ease;
            overflow: hidden;
            z-index: 999;
        }

        .activities-panel.active {
            width: 40%;
        }

        .activities-panel-content {
            padding: 2rem;
            min-width: 400px;
            margin-top: 80px;
        }

        .activities-panel .section-header {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(76, 81, 191, 0.1);
            border-radius: 8px;
        }

        .activities-panel .section-header h2 {
            font-size: 1rem;
            margin: 0;
        }

        .close-activities {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 32px;
            height: 32px;
            border: none;
            background: rgba(76, 81, 191, 0.1);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4c51bf;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .close-activities:hover {
            background: #4c51bf;
            color: white;
        }

        /* Section headers and create buttons */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 1rem 2rem;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .section-header h2 {
            color: #4c51bf;
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0;
        }

        .filter-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .create-btn {
            padding: 10px 20px;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s ease;
            white-space: nowrap;
        }

        .create-btn:hover {
            background: #059669;
        }

        /* Item grids and cards for services, forums, policies */
        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .item-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .item-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .item-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .item-card h3 {
            color: #1f2937;
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .item-card p {
            color: #6b7280;
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 1rem;
        }

        .item-meta {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #4c51bf;
            font-weight: 500;
        }

        /* Home Page */
        .placeholder-page {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 3rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .placeholder-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #4c51bf, #667eea);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            margin: 0 auto 2rem;
        }

        .filters {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .search-container {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px 12px 44px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #4c51bf;
        }

        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
        }

        .filter-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: #4c51bf;
            color: white;
            border-color: #4c51bf;
        }

        .users-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .user-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .user-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .card-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4c51bf, #667eea);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .cert-score {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4c51bf, #667eea);
            color: white;
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 1rem;
        }

        .user-name {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .user-bio {
            color: #6b7280;
            font-size: 14px;
            margin-bottom: 1rem;
            line-height: 1.4;
        }

        .user-meta {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 12px;
        }

        .meta-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 8px;
            background: #f3f4f6;
            border-radius: 6px;
        }

        .meta-label {
            font-weight: 500;
            color: #374151;
        }

        .meta-value {
            font-weight: 600;
            color: #4c51bf;
        }

        .user-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 12px;
            color: #6b7280;
        }

        .follow-btn {
            width: 100%;
            padding: 10px;
            background: #4c51bf;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .follow-btn:hover {
            background: #3730a3;
        }

        .follow-btn.following {
            background: #10b981;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
            font-size: 18px;
            color: #6b7280;
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #6b7280;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .nav-container {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }

            .nav-links {
                gap: 1rem;
                flex-wrap: wrap;
                justify-content: center;
            }

            .page-content {
                padding: 1rem;
            }

            .users-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Activities Sliding Panel -->
    <div id="activitiesPanel" class="activities-panel">
        <button class="close-activities" onclick="app.closeActivities()">×</button>
        <div class="activities-panel-content">
            <div class="section-header">
                <h2>Track user activities across forums, policies, and services</h2>
            </div>
            <div class="placeholder-page">
                <div class="placeholder-icon">📋</div>
                <p>Monitor and manage user activities across all forums and policies they participate in. Activities are automatically generated when users interact with policies, forums, or services.</p>
            </div>
        </div>
    </div>

    <!-- Activities Sliding Panel -->
    <div id="activitiesPanel" class="activities-panel">
        <button class="close-activities" onclick="app.closeActivities()">×</button>
        <div class="activities-panel-content">
            <div class="section-header">
                <h2>Track user activities across forums, policies, and services</h2>
            </div>
            <div class="placeholder-page">
                <div class="placeholder-icon">📋</div>
                <p>Monitor and manage user activities across all forums and policies they participate in. Activities are automatically generated when users interact with policies, forums, or services.</p>
            </div>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav class="main-nav">
        <div class="nav-container">
            <a href="#" class="logo" onclick="app.showSection('activities')">
                <div class="logo-icon">
                    <svg width="24" height="24" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="16" cy="11.5" r="4" fill="white"/>
                        <circle cx="11" cy="20.5" r="4" fill="white"/>
                        <circle cx="21" cy="20.5" r="4" fill="white"/>
                    </svg>
                </div>
                <span>Eleutherios</span>
            </a>
            
            <ul class="nav-links">
                <li><a href="#" class="nav-link" data-section="newsfeed" onclick="app.showSection('newsfeed')" title="Home">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                    </svg>
                </a></li>
                <li><a href="#" class="nav-link" data-section="forums" onclick="app.showSection('forums')" title="Forums">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                    </svg>
                </a></li>
                <li><a href="#" class="nav-link" data-section="services" onclick="app.showSection('services')" title="Services">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                    </svg>
                </a></li>
                <li><a href="#" class="nav-link" data-section="policies" onclick="app.showSection('policies')" title="Policies">
                    <span class="material-icons" style="font-size: 20px;">account_balance</span>
                </a></li>
                <li><a href="#" class="nav-link" data-section="users" onclick="app.showSection('users')" title="Users">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                    </svg>
                </a></li>
            </ul>
            
            <div class="user-menu">
                <div class="cart-icon" onclick="app.showSection('shopping')" title="Shopping Cart">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="9" cy="21" r="1"/>
                        <circle cx="20" cy="21" r="1"/>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                    </svg>
                </div>
                <div class="user-avatar" onclick="app.toggleUserMenu()">U</div>
                
                <!-- User Menu Flyout -->
                <div class="user-menu-flyout" id="userMenuFlyout">
                    <div class="user-menu-header">
                        <div class="user-info">
                            <div class="user-menu-avatar">U</div>
                            <div class="user-details">
                                <div class="user-menu-name">Signed in as</div>
                                <div class="user-menu-email" onclick="app.showSection('dashboard')">rob.kara@gmail.com</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="user-menu-stats">
                        <div class="menu-stat-item" onclick="app.showSection('policies')">
                            <span class="stat-label">Policies</span>
                            <span class="stat-count">(1)</span>
                        </div>
                        <div class="menu-stat-item" onclick="app.showSection('forums')">
                            <span class="stat-label">Forums</span>
                            <span class="stat-count">(1)</span>
                        </div>
                        <div class="menu-stat-item" onclick="app.showSection('services')">
                            <span class="stat-label">Services</span>
                            <span class="stat-count">(1)</span>
                        </div>
                        <div class="menu-stat-item">
                            <span class="stat-label">Favorites</span>
                            <span class="stat-count">(0)</span>
                        </div>
                        <div class="menu-stat-item">
                            <span class="stat-label">Following</span>
                            <span class="stat-count">(0)</span>
                        </div>
                    </div>
                    
                    <div class="user-menu-actions">
                        <div class="menu-action-item">Payments</div>
                        <div class="menu-action-item">Receipts</div>
                        <div class="menu-action-item logout" onclick="app.logout()">Logout</div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Page Container -->
    <div class="page-container">
        <div class="page-content">
            
            <!-- Dashboard Section -->
            <section id="dashboard" class="page-section">
                <div class="dashboard-header">
                    <h1>Dashboard</h1>
                </div>
                
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Stripe Balance</h3>
                        <div class="balance-amount">$1250.75</div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h3>Favorites</h3>
                        <div class="stat-number blue">0</div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h3>Following</h3>
                        <div class="stat-number purple">0</div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h3>Income vs Expense</h3>
                        <div class="income-stats">
                            <div class="income-item">
                                <span class="income-dot green"></span>
                                <span>Income: $400</span>
                            </div>
                            <div class="income-item">
                                <span class="income-dot red"></span>
                                <span>Expense: $200</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="my-content-section">
                    <div class="content-header">
                        <h2>My Policies (1)</h2>
                        <div class="view-toggle">
                            <button class="toggle-btn active">List</button>
                            <button class="toggle-btn">Grid</button>
                        </div>
                    </div>
                    
                    <div class="policy-item">
                        <div class="policy-content">
                            <div class="policy-title">
                                <span class="policy-name">Social Housing</span>
                                <span class="policy-tag housing">housing</span>
                                <span class="policy-tag draft">draft</span>
                            </div>
                            <div class="policy-description">help get people into housing</div>
                            <div class="policy-date">📅 Created 29/09/2025</div>
                        </div>
                        <button class="edit-btn">Edit</button>
                    </div>
                </div>
                
                <div class="my-content-section">
                    <div class="content-header">
                        <h2>My Services (1)</h2>
                        <div class="view-toggle">
                            <button class="toggle-btn active">List</button>
                            <button class="toggle-btn">Grid</button>
                            <button class="add-btn">+</button>
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-avatar">N</div>
                        <div class="service-content">
                            <div class="service-title">
                                <span class="service-name">Homeless Person</span>
                                <span class="service-tag personal">personal</span>
                            </div>
                            <div class="service-description">No description</div>
                        </div>
                        <button class="edit-btn">Edit</button>
                    </div>
                </div>
            </section>
            <section id="home" class="page-section">
                <div class="placeholder-page">
                    <div class="placeholder-icon">🏠</div>
                    <h2>Welcome to Eleutherios</h2>
                    <p>A shared operating system for humankind — enabling policies to be instantiated into live forums, connected with services, and grounded in data.</p>
                </div>
            </section>

            <section id="newsfeed" class="page-section active">
                <div class="section-header">
                    <h2>Your personalized feed of activities, updates, and community content</h2>
                </div>
                <div class="placeholder-page">
                    <div class="placeholder-icon">📰</div>
                    <p>Stay up to date with the latest activities from your followed users, policy updates, forum discussions, and service announcements.</p>
                </div>
            </section>

            <!-- Forums Section -->
            <section id="forums" class="page-section">
                <div class="section-header">
                    <h2>Spaces for dialogue, collaboration, and coordination</h2>
                    <button class="create-btn" onclick="app.createForum()">Create Forum</button>
                </div>
                <div class="placeholder-page">
                    <div class="placeholder-icon">💬</div>
                    <p>Instantiated expressions of policy rules for community discussion and collaborative decision-making.</p>
                </div>
            </section>

            <!-- Services Section -->
            <section id="services" class="page-section">
                <div class="section-header">
                    <h2>Analogue and digital agents that perform actions and consume policies</h2>
                    <button class="create-btn" onclick="app.createService()">Create Service</button>
                </div>
                <div class="placeholder-page">
                    <div class="placeholder-icon">⚙️</div>
                    <p>Browse and manage services that implement policy rules and provide functionality to the community.</p>
                </div>
            </section>

            <!-- Policies Section -->
            <section id="policies" class="page-section">
                <div class="section-header">
                    <h2>Root governance objects containing rules that define system behavior</h2>
                    <button class="create-btn" onclick="app.createPolicy()">Create Policy</button>
                </div>
                <div class="placeholder-page">
                    <div class="placeholder-icon">📋</div>
                    <p>Create, manage, and explore governance policies. Policies contain rules that instantiate into forums, services, or other policies.</p>
                </div>
            </section>

            <!-- Users Section -->
            <section id="users" class="page-section">
                <div class="filters">
                    <div class="search-container">
                        <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="M21 21l-4.35-4.35"></path>
                        </svg>
                        <input type="text" class="search-input" placeholder="Search users by name or expertise..." id="searchInput">
                    </div>
                    <div class="filter-row">
                        <div class="filter-buttons">
                            <button class="filter-btn active" data-filter="all">All Users</button>
                            <button class="filter-btn" data-filter="high-cert">High CERT Score</button>
                            <button class="filter-btn" data-filter="active">Recently Active</button>
                            <button class="filter-btn" data-filter="service-providers">Service Providers</button>
                            <button class="filter-btn" data-filter="highly-followed">Highly Followed</button>
                        </div>
                        <button class="create-btn" onclick="app.createUser()">Create Profile</button>
                    </div>
                </div>

                <div id="usersContainer">
                    <div class="loading">Loading users...</div>
                </div>
            </section>

            <!-- Shopping Section -->
            <section id="shopping" class="page-section">
                <div class="section-header">
                    <h2>Browse and purchase services and policy implementations</h2>
                </div>
                <div class="placeholder-page">
                    <div class="placeholder-icon">🛒</div>
                    <p>Discover and purchase services that implement governance policies and community solutions.</p>
                </div>
            </section>

        </div> <!-- End page-content -->
    </div> <!-- End page-container -->

    <script>
        class UsersManager {
            constructor() {
                this.users = [];
                this.filteredUsers = [];
                this.currentFilter = 'all';
                this.searchTerm = '';
                this.loaded = false;
                this.setupEventListeners();
            }

            async loadIfNeeded() {
                console.log('loadIfNeeded called, loaded:', this.loaded);
                if (!this.loaded) {
                    await this.loadUsers();
                    this.renderUsers();
                    this.loaded = true;
                } else {
                    this.renderUsers();
                }
            }

            async loadUsers() {
                try {
                    const response = await fetch('/api/users/public');
                    if (response.ok) {
                        const data = await response.json();
                        this.users = data.users || data;
                    } else {
                        this.users = this.generateMockUsers();
                    }
                } catch (error) {
                    console.log('API not available, using mock data');
                    this.users = this.generateMockUsers();
                }
                this.filteredUsers = [...this.users];
            }

            generateMockUsers() {
                const names = [
                    'Alice Johnson', 'Bob Smith', 'Carol Davis', 'David Wilson',
                    'Eva Brown', 'Frank Miller', 'Grace Lee', 'Henry Taylor',
                    'Iris Chen', 'Jack Anderson', 'Kate Rodriguez', 'Leo Thompson'
                ];

                const bios = [
                    'Policy researcher focused on sustainable governance models',
                    'Community organizer with expertise in participatory democracy',
                    'Tech entrepreneur building governance solutions',
                    'Social scientist studying collective decision-making',
                    'Legal expert in constitutional frameworks',
                    'Data analyst for policy impact measurement',
                    'Forum moderator and conflict resolution specialist',
                    'Service provider for digital identity verification',
                    'Governance consultant for DAOs and cooperatives',
                    'Academic researcher in political science',
                    'Community builder and stakeholder engagement expert',
                    'Software developer contributing to open governance'
                ];

                return names.map((name, index) => ({
                    id: 'user-' + (index + 1),
                    name: name,
                    email: name.toLowerCase().replace(' ', '.') + '@eleutherios.org',
                    bio: bios[index],
                    avatar: name.split(' ').map(n => n[0]).join(''),
                    certScore: Math.floor(Math.random() * 100),
                    stats: {
                        followers: Math.floor(Math.random() * 100),
                        following: Math.floor(Math.random() * 80),
                        services: Math.floor(Math.random() * 10),
                        activities: Math.floor(Math.random() * 20),
                        favourites: Math.floor(Math.random() * 15)
                    },
                    lastActive: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString(),
                    isFollowing: false,
                    location: ['Christchurch, NZ', 'Auckland, NZ', 'Wellington, NZ'][Math.floor(Math.random() * 3)]
                }));
            }

            setupEventListeners() {
                document.addEventListener('input', (e) => {
                    if (e.target.id === 'searchInput') {
                        this.searchTerm = e.target.value.toLowerCase();
                        this.applyFilters();
                    }
                });

                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('filter-btn')) {
                        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.currentFilter = e.target.dataset.filter;
                        this.applyFilters();
                    }
                });
            }

            applyFilters() {
                if (!this.loaded) return;

                let filtered = [...this.users];

                if (this.searchTerm) {
                    filtered = filtered.filter(user => 
                        user.name.toLowerCase().includes(this.searchTerm) ||
                        user.bio.toLowerCase().includes(this.searchTerm) ||
                        user.email.toLowerCase().includes(this.searchTerm)
                    );
                }

                switch (this.currentFilter) {
                    case 'high-cert':
                        filtered = filtered.filter(user => user.certScore >= 70);
                        break;
                    case 'active':
                        filtered = filtered.filter(user => {
                            const daysSinceActive = (Date.now() - new Date(user.lastActive)) / (1000 * 60 * 60 * 24);
                            return daysSinceActive <= 7;
                        });
                        break;
                    case 'service-providers':
                        filtered = filtered.filter(user => user.stats.services >= 3);
                        break;
                    case 'highly-followed':
                        filtered = filtered.filter(user => user.stats.followers >= 30);
                        break;
                }

                this.filteredUsers = filtered;
                this.renderUsers();
            }

            renderUsers() {
                const container = document.getElementById('usersContainer');
                if (!container) return;
                
                if (this.filteredUsers.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <h3>No users found</h3>
                            <p>Try adjusting your search criteria or filters.</p>
                        </div>
                    `;
                    return;
                }

                const usersHTML = this.filteredUsers.map(user => `
                    <div class="user-card">
                        <div class="card-avatar">${user.avatar}</div>
                        <div class="cert-score">${user.certScore}</div>
                        <div class="user-name">${user.name}</div>
                        <div class="user-bio">${user.bio}</div>
                        
                        <div class="user-meta">
                            <div class="meta-item">
                                <span class="meta-label">Followers</span>
                                <span class="meta-value">${user.stats.followers}</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Following</span>
                                <span class="meta-value">${user.stats.following}</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Services</span>
                                <span class="meta-value">${user.stats.services}</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Activities</span>
                                <span class="meta-value">${user.stats.activities}</span>
                            </div>
                        </div>

                        <div class="user-stats">
                            <span>${user.location || 'Location not set'}</span>
                            <span>CERT: ${user.certScore}</span>
                        </div>

                        <button class="follow-btn ${user.isFollowing ? 'following' : ''}" 
                                onclick="app.usersManager.toggleFollow('${user.id}')">
                            ${user.isFollowing ? 'Following' : 'Follow'}
                        </button>
                    </div>
                `).join('');

                container.innerHTML = `<div class="users-grid">${usersHTML}</div>`;
            }

            async toggleFollow(userId) {
                const user = this.users.find(u => u.id === userId);
                if (user) {
                    user.isFollowing = !user.isFollowing;
                    
                    try {
                        await fetch(`/api/users/${userId}/follow`, {
                            method: user.isFollowing ? 'POST' : 'DELETE',
                            headers: { 'Content-Type': 'application/json' }
                        });
                    } catch (error) {
                        console.log('Follow API not available');
                    }
                    
                    this.renderUsers();
                }
            }
        }

        class ServicesManager {
            constructor() {
                this.services = [];
                this.loaded = false;
            }

            async loadIfNeeded() {
                if (!this.loaded) {
                    await this.loadServices();
                    this.renderServices();
                    this.loaded = true;
                } else {
                    this.renderServices();
                }
            }

            async loadServices() {
                try {
                    const response = await fetch('/api/services/public');
                    if (response.ok) {
                        const data = await response.json();
                        this.services = data.services || data;
                    } else {
                        this.services = this.generateMockServices();
                    }
                } catch (error) {
                    console.log('Services API not available, using mock data');
                    this.services = this.generateMockServices();
                }
            }

            generateMockServices() {
                const serviceTypes = [
                    'Identity Verification', 'Payment Processing', 'Document Storage',
                    'Conflict Resolution', 'Community Moderation', 'Policy Template',
                    'Forum Management', 'Data Analytics', 'Voting System',
                    'Notification Service', 'File Sharing', 'Translation Service'
                ];

                return serviceTypes.map((type, index) => ({
                    id: 'service-' + (index + 1),
                    title: type + ' Service',
                    description: `Provides ${type.toLowerCase()} functionality for the community`,
                    ownerId: 'user-' + Math.floor(Math.random() * 12 + 1),
                    price: Math.random() > 0.5 ? Math.floor(Math.random() * 100) + 10 : 0,
                    currency: 'NZD',
                    status: 'Active',
                    createdAt: new Date(Date.now() - Math.random() * 365 * 24 * 60 * 60 * 1000).toISOString()
                }));
            }

            renderServices() {
                const container = document.querySelector('#services .placeholder-page');
                if (!container) return;

                const servicesHTML = this.services.map(service => `
                    <div class="item-card">
                        <div class="item-icon">⚙️</div>
                        <h3>${service.title}</h3>
                        <p>${service.description}</p>
                        <div class="item-meta">
                            <span>Price: ${service.price === 0 ? 'Free' : '$' + service.price + ' ' + service.currency}</span>
                            <span>Status: ${service.status}</span>
                        </div>
                    </div>
                `).join('');

                container.innerHTML = `<div class="items-grid">${servicesHTML}</div>`;
            }
        }

        class ForumsManager {
            constructor() {
                this.forums = [];
                this.loaded = false;
            }

            async loadIfNeeded() {
                if (!this.loaded) {
                    await this.loadForums();
                    this.renderForums();
                    this.loaded = true;
                } else {
                    this.renderForums();
                }
            }

            async loadForums() {
                try {
                    const response = await fetch('/api/forums/public');
                    if (response.ok) {
                        const data = await response.json();
                        this.forums = data.forums || data;
                    } else {
                        this.forums = this.generateMockForums();
                    }
                } catch (error) {
                    console.log('Forums API not available, using mock data');
                    this.forums = this.generateMockForums();
                }
            }

            generateMockForums() {
                const forumTopics = [
                    'General Discussion', 'Policy Development', 'Technical Support',
                    'Community Guidelines', 'Feature Requests', 'Governance Proposals',
                    'Service Feedback', 'New Member Introductions', 'Project Collaboration',
                    'Resource Sharing', 'Event Planning', 'Local Chapters'
                ];

                return forumTopics.map((topic, index) => ({
                    id: 'forum-' + (index + 1),
                    title: topic,
                    description: `Forum for discussing ${topic.toLowerCase()}`,
                    stakeholders: Math.floor(Math.random() * 50) + 5,
                    messages: Math.floor(Math.random() * 200) + 10,
                    createdAt: new Date(Date.now() - Math.random() * 365 * 24 * 60 * 60 * 1000).toISOString()
                }));
            }

            renderForums() {
                const container = document.querySelector('#forums .placeholder-page');
                if (!container) return;

                const forumsHTML = this.forums.map(forum => `
                    <div class="item-card">
                        <div class="item-icon">💬</div>
                        <h3>${forum.title}</h3>
                        <p>${forum.description}</p>
                        <div class="item-meta">
                            <span>${forum.stakeholders} members</span>
                            <span>${forum.messages} messages</span>
                        </div>
                    </div>
                `).join('');

                container.innerHTML = `<div class="items-grid">${forumsHTML}</div>`;
            }
        }

        class PoliciesManager {
            constructor() {
                this.policies = [];
                this.loaded = false;
            }

            async loadIfNeeded() {
                if (!this.loaded) {
                    await this.loadPolicies();
                    this.renderPolicies();
                    this.loaded = true;
                } else {
                    this.renderPolicies();
                }
            }

            async loadPolicies() {
                try {
                    const response = await fetch('/api/policies/public');
                    if (response.ok) {
                        const data = await response.json();
                        this.policies = data.policies || data;
                    } else {
                        this.policies = this.generateMockPolicies();
                    }
                } catch (error) {
                    console.log('Policies API not available, using mock data');
                    this.policies = this.generateMockPolicies();
                }
            }

            generateMockPolicies() {
                const policyTypes = [
                    'Community Guidelines', 'Data Privacy Policy', 'Service Terms',
                    'Governance Protocol', 'Conflict Resolution', 'Member Rights',
                    'Content Moderation', 'Financial Transparency', 'Open Source License',
                    'Accessibility Standards', 'Security Framework', 'Environmental Impact'
                ];

                return policyTypes.map((type, index) => ({
                    id: 'policy-' + (index + 1),
                    title: type,
                    description: `Defines rules and guidelines for ${type.toLowerCase()}`,
                    visibility: Math.random() > 0.3 ? 'public' : 'private',
                    rules: Math.floor(Math.random() * 10) + 1,
                    createdAt: new Date(Date.now() - Math.random() * 365 * 24 * 60 * 60 * 1000).toISOString()
                }));
            }

            renderPolicies() {
                const container = document.querySelector('#policies .placeholder-page');
                if (!container) return;

                const policiesHTML = this.policies.map(policy => `
                    <div class="item-card">
                        <div class="item-icon">🏛️</div>
                        <h3>${policy.title}</h3>
                        <p>${policy.description}</p>
                        <div class="item-meta">
                            <span>${policy.rules} rules</span>
                            <span>${policy.visibility}</span>
                        </div>
                    </div>
                `).join('');

                container.innerHTML = `<div class="items-grid">${policiesHTML}</div>`;
            }
        }

        class EleutherosApp {
            constructor() {
                this.currentSection = 'newsfeed';
                this.userMenuOpen = false;
                this.activitiesOpen = false;
                this.usersManager = new UsersManager();
                this.servicesManager = new ServicesManager();
                this.forumsManager = new ForumsManager();
                this.policiesManager = new PoliciesManager();
                this.init();
            }

            init() {
                this.showSection('newsfeed');
                this.usersManager.loadIfNeeded();
                this.setupGlobalEventListeners();
            }

            setupGlobalEventListeners() {
                // Close user menu when clicking outside
                document.addEventListener('click', (e) => {
                    const userMenu = document.querySelector('.user-menu');
                    if (this.userMenuOpen && !userMenu.contains(e.target)) {
                        this.closeUserMenu();
                    }
                });
            }

            toggleUserMenu() {
                const flyout = document.getElementById('userMenuFlyout');
                if (!flyout) return;

                if (this.userMenuOpen) {
                    this.closeUserMenu();
                } else {
                    this.openUserMenu();
                }
            }

            openUserMenu() {
                const flyout = document.getElementById('userMenuFlyout');
                if (flyout) {
                    flyout.classList.add('active');
                    this.userMenuOpen = true;
                }
            }

            closeUserMenu() {
                const flyout = document.getElementById('userMenuFlyout');
                if (flyout) {
                    flyout.classList.remove('active');
                    this.userMenuOpen = false;
                }
            }

            openActivities() {
                const panel = document.getElementById('activitiesPanel');
                const pageContent = document.querySelector('.page-content');
                
                if (panel && pageContent) {
                    panel.classList.add('active');
                    pageContent.classList.add('activities-open');
                    this.activitiesOpen = true;
                }
            }

            closeActivities() {
                const panel = document.getElementById('activitiesPanel');
                const pageContent = document.querySelector('.page-content');
                
                if (panel && pageContent) {
                    panel.classList.remove('active');
                    pageContent.classList.remove('activities-open');
                    this.activitiesOpen = false;
                }
                
                // Update nav link state
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                
                const activeLink = document.querySelector(`[data-section="${this.currentSection}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
            }

            logout() {
                // Add logout functionality here
                alert('Logout functionality - This would handle user logout');
                this.closeUserMenu();
            }

            showSection(sectionId) {
                // Handle activities as a special case - toggle the sliding panel
                if (sectionId === 'activities') {
                    if (this.activitiesOpen) {
                        this.closeActivities();
                    } else {
                        this.openActivities();
                        
                        // Update nav link state for activities
                        document.querySelectorAll('.nav-link').forEach(link => {
                            link.classList.remove('active');
                        });
                        
                        const activeLink = document.querySelector(`[data-section="activities"]`);
                        if (activeLink) {
                            activeLink.classList.add('active');
                        }
                    }
                    return;
                }
                
                // DON'T close activities panel when navigating to other sections
                // The panel should persist until manually closed
                
                // Handle normal page sections
                document.querySelectorAll('.page-section').forEach(section => {
                    section.classList.remove('active');
                });

                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.add('active');
                    this.currentSection = sectionId;
                }

                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                
                const activeLink = document.querySelector(`[data-section="${sectionId}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                }

                // Close user menu when navigating
                this.closeUserMenu();

                switch(sectionId) {
                    case 'users':
                        this.usersManager.loadIfNeeded();
                        break;
                    case 'services':
                        this.servicesManager.loadIfNeeded();
                        break;
                    case 'forums':
                        this.forumsManager.loadIfNeeded();
                        break;
                    case 'policies':
                        this.policiesManager.loadIfNeeded();
                        break;
                }
            }

            createUser() {
                alert('Create User Profile - This will open a form to create a new user profile');
            }

            createForum() {
                alert('Create Forum - This will open a form to create a new discussion forum');
            }

            createService() {
                alert('Create Service - This will open a form to create a new service');
            }

            createPolicy() {
                alert('Create Policy - This will open a form to create a new governance policy');
            }
        }

        const app = new EleutherosApp();
    </script>
</body>
</html>